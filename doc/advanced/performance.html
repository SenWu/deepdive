<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="DeepDive" />
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="http://deepdive.stanford.edu/stylesheets/application.css" />
    <link rel="canonical" href="http://deepdive.stanford.edu">
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="http://deepdive.stanford.edu/javascripts/application.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepDive</title>
  </head>

  <body>
      <script type="text/javascript">
window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
window.analytics.load("h6uwk48gwg");
window.analytics.page();
</script>
      <a href="https://github.com/hazyresearch/deepdive" target="_blank"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>

      <div id="header">
        <div class="container">
          <row>
            <div class="col-md-4 col-md-offset-1">
              <a href="http://deepdive.stanford.edu/" class="deepdive-logo">
              <img src="http://deepdive.stanford.edu/images/header_logo.png" style="width: 250px;"/>
              </a> 
            </div>
            <div class="col-md-6 col-md-offset-1">
              <ul class="list-unstyled list-inline" id="header-nav">
                <li><a href="http://deepdive.stanford.edu/index.html">Home</a></li>
                <li><a href="http://deepdive.stanford.edu/doc/basics/installation.html">Download</a></li>
                <li><a href="http://deepdive.stanford.edu/index.html#documentation">Documentation</a></li>
                <li><a href="https://mailman.stanford.edu/mailman/listinfo/deepdive-list" target="_blank">Mailing List</a></li>
              </ul>
              
            </div>
          </row>
        </div>
      </div>

      <section id="main">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <h1>Performance Tuning</h1>

<p>Processing large amounts of data may expose bottlenecks in various parts of the
system. The following sections show how to tune different parameters to obtain
better performances.</p>

<h3><a name="parallelgrounding" href="#"></a> Parallel grounding</h3>

<p><a href="../basics/overview.html#grounding">Grounding</a> is the process of building the
factor graph. If you are using Greenplum, you can enable parallel grounding to
speed up the grounding phase, which makes use of Greenplum&#39;s parallel file
system (gpfdist). To use parallel grounding, first make sure that Greenplum&#39;s file
system server <code>gpfdist</code> is running locally, i.e., on the machine where you will
run the DeepDive applications. If it is not running, you can use the following
command to start gpfdist</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">gpfdist -d [directory] -p [port] &amp;
</code></pre></div>
<p>where you specify the directory for storing the files and the HTTP port to run on.
Then, in <code>application.conf</code>, specify the gpfdist settings in the <code>db.default</code> as
follows</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">db.default {
  gphost   : [host of gpfdist]
  gpport   : [port of gpfdist]
  gppath   : [path to gpfdist directory]
}
</code></pre></div>
<p>Finally, tell DeepDive to use parallel grounding by adding the following to
<code>application.conf</code>: </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">inference.parallel_grounding: true
</code></pre></div>
<h3>Setting the JVM heap size</h3>

<p>Use the <code>-Xmx</code> flag to the <code>java</code> command to set the maximum heap size for the
Java Virtual Machine. The default heap size is the minimum between one quarter of
the physical memory and 1GB. If you use <a href="http://www.scala-sbt.org/">SBT</a> to run
a DeepDive application , you can set the heap size as follows:
<code>bash
    SBT_OPTS=&quot;-Xmx8g&quot; sbt &quot;run -c path_to_application.conf&quot;
</code></p>

<h3>Setting extractor parallelism and batch sizes</h3>

<p>For <code>json_extracor</code> and <code>tsv_extractor</code>, you can execute multiple copies of an extractor in parallel using the
<code>paralleism</code> option. In <code>plpy_extractor</code> the parallelism is managed by database.</p>

<p>For <code>json_extracor</code> and <code>tsv_extractor</code>, you can use the <code>input_batch_size</code> option to define how
many tuples each extractor should receive at once, and the <code>output_batch_size</code>
option to define how many extracted tuples should be inserted into the data
store at once. The <a href="../basics/extractors.html#jsonparallelism">extractor
documentation</a> contains more details about
these options. </p>

<h3>Setting the batch size for factor graph construction</h3>

<p>By default, DeepDive inserts variables, factors and weights in batches defined
by the underlying data store. This can be change by defining a value for the
<code>inference.batch_size</code> directive. Refer to the <a href="../basics/configuration.html#batch_size">&quot;Configuration
reference&quot;</a> for more details about this
directive.</p>

            </div>
          </row>
        </div>
      </section>
    
      <footer id="footer">
        <div class="container">
          <row>
            <div class="col-md-10 col-md-offset-1">
              <p class="pull-left"> 
                Copyright, 2014 deepdive.stanford.edu
                â‹…
                <a href="mailto:contact.hazy@gmail.com">Questions? Email us</a>
              </p>
              <p class="pull-right"> 
                Visit DeepDive on <a href="https://github.com/hazyresearch/deepdive" target="_blank">Github</a> 
              </p>
            </div>
          </row>
        </div>
      </footer>

    
  
  </body>
</html>
